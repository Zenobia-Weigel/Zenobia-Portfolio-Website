{% assign photos = site.data.gallery.photos %}

<section class="gallery">
  {% if include.title %}
  <div class="gallery__header">
    <h2 class="gallery__title">{{ include.title }}</h2>
    {% if include.subtitle %}
    <p class="gallery__subtitle">{{ include.subtitle }}</p>
    {% endif %}
  </div>
  {% endif %}

  <div class="gallery__grid">
    {% for photo in photos limit: include.limit | default: 12 %}
    <article class="photo-item">
      {% if photo.link %}
      <a href="{{ photo.link }}" target="_blank" rel="noopener" class="photo-item__link">
      {% endif %}

      {% if photo.image contains "placeholder" %}
        <div class="photo-item__placeholder">
          <span class="photo-item__placeholder-text">Photo {{ forloop.index }}</span>
        </div>
      {% else %}
        <img src="{{ photo.image | relative_url }}"
             alt="{{ photo.caption | default: 'Portfolio photo' }}"
             class="photo-item__image"
             loading="lazy">
      {% endif %}

      {% if photo.caption or photo.category %}
      <div class="photo-item__overlay">
        {% if photo.caption %}
        <p class="photo-item__caption">{{ photo.caption }}</p>
        {% endif %}
        {% if photo.category %}
        <span class="photo-item__category">{{ photo.category | replace: "-", " " }}</span>
        {% endif %}
      </div>
      {% endif %}

      {% if photo.link %}
      </a>
      {% endif %}
    </article>
    {% endfor %}
  </div>
</section>
